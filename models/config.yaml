# Model Configuration Template
# Copy this to config.yaml and adjust as needed

model:
  name: "ft_transformer"
  d_token: 128
  n_layers: 3
  n_heads: 4
  dropout: 0.1
  activation: "gelu"

training:
  batch_size: 64
  learning_rate: 0.001
  weight_decay: 0.0001
  num_epochs: 100
  early_stopping_patience: 10
  early_stopping_min_delta: 0.001

features:
  walk_15min_radius_meters: 1200  # 15-minute walk radius in meters (default: 1200m ≈ 1.2 km)
  grid_cell_size_meters: 100  # Size of grid cells for spatial context (default: 100m × 100m)
  max_context_points: null  # Auto-calculate based on radius and cell size: ceil(π × (radius/cell_size)²) + buffer, or set explicitly

loss:
  type: "distance_similarity"  # Distance-based similarity loss using KL divergence
  temperature: 200  # Temperature parameter τ for distance-to-probability conversion (in meters)
  use_network_distance: true  # Use OSMnx network distance, not Euclidean
  missing_service_penalty: 2400  # Distance (meters) to use when service category is missing

data:
  train_split: 0.7
  val_split: 0.15
  test_split: 0.15
  random_seed: 42
  train_only_on_compliant: true  # Critical: train only on compliant neighborhoods

evaluation:
  statistical_test: "mann_whitney"  # ttest or mann_whitney
  significance_level: 0.05
  min_samples_for_test: 10

paths:
  data_root: "./data"
  neighborhoods_geojson: "./paris_neighborhoods.geojson"
  checkpoints_dir: "./models/checkpoints"
  experiments_dir: "./experiments/runs"

osm_extraction:
  buffer_meters: 100  # Buffer around neighborhood boundaries
  network_type: "walk"  # 'walk', 'drive', 'bike', 'all'
  simplify: true  # Simplify network geometry
  cache_results: true  # Skip if data already exists
  retry_attempts: 3  # Number of retries on failure
  retry_delay: 5  # Seconds between retries
  min_services_warning: 5  # Warn if fewer services found

census_extraction:
  cache_results: true  # Skip if data already exists
  retry_attempts: 3  # Number of retries on failure
  retry_delay: 5  # Seconds between retries
  paris_geocode: "75056"  # INSEE code for Paris
  iris_level: "IRIS"  # Geographic level
  min_data_warning: 10  # Warn if fewer IRIS units found
