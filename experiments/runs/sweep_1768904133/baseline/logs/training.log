[2026-01-20 12:15:33] [INFO] [experiment] Starting training
[2026-01-20 12:15:33] [INFO] [experiment] Using device: mps
[2026-01-20 12:15:33] [INFO] [experiment] Loading features from data/processed/features/compliant
[2026-01-20 12:15:33] [INFO] [src.training.dataset] Found 7 target_points.parquet files in data/processed/features/compliant
[2026-01-20 12:15:35] [INFO] [src.training.dataset] Combined 3636 total rows from 7 files, 7 unique neighborhoods
[2026-01-20 12:15:35] [INFO] [src.training.dataset] Created splits: Train=1844 rows (4 neighborhoods), Val=308 rows (1 neighborhoods), Test=1484 rows (2 neighborhoods)
[2026-01-20 12:15:35] [INFO] [experiment] Calculating class weights from training dataset...
[2026-01-20 12:15:35] [INFO] [experiment] Class counts: [487, 60, 478, 208, 27, 64, 479, 41]
[2026-01-20 12:15:35] [INFO] [experiment] Class weights (before damping): [3.786447525024414, 30.733333587646484, 3.857740640640259, 8.865385055541992, 68.29629516601562, 28.8125, 3.849686861038208, 44.975608825683594]
[2026-01-20 12:15:35] [INFO] [experiment] Class weights (after sqrt damping and capping at 3.0): [1.945879578590393, 3.0, 1.9641132354736328, 2.9774796962738037, 3.0, 3.0, 1.962061882019043, 3.0]
[2026-01-20 12:15:35] [INFO] [experiment] Data augmentation enabled: feature_noise (p=0.8, std=0.01), neighbor_subsampling (p=0.5, ratio=0.8), edge_noise (p=0.3, std=0.02)
[2026-01-20 12:15:35] [INFO] [experiment] Computing true class distribution from training dataset...
[2026-01-20 12:15:37] [INFO] [experiment] True distribution: ['0.1571', '0.0913', '0.1712', '0.1383', '0.0718', '0.0792', '0.1926', '0.0985']
[2026-01-20 12:15:37] [INFO] [experiment] Created datasets: Train=1844, Val=308, Test=1484
[2026-01-20 12:15:37] [INFO] [src.training.model] Created SpatialGraphTransformer: 47,752 parameters
[2026-01-20 12:15:37] [INFO] [experiment] Loss function: label_smoothing=0.0, class_weights capped at 3.0, entropy_weight=0.5, min_entropy=0.5, entropy_penalty_type=linear, maxsup_weight=0.0, maxsup_threshold=0.0
[2026-01-20 12:15:37] [INFO] [experiment] Optimizer: using separate weight decay - base=0.001, final_layer=0.011
[2026-01-20 12:15:37] [INFO] [experiment] Initialized prediction distribution file: experiments/runs/sweep_1768904133/baseline/prediction_distributions.json
[2026-01-20 12:15:37] [INFO] [experiment] Starting training loop
[2026-01-20 12:16:31] [INFO] [experiment] Epoch 1/20 (53.61s): train_loss=0.7140, train_top1=0.0146, train_top3=0.8308, val_loss=0.5257, val_kl=0.2399, val_top1=0.0260, val_top3=0.8994
[2026-01-20 12:16:57] [INFO] [experiment] Computing prediction distribution for epoch 1...
[2026-01-20 12:17:13] [INFO] [experiment] Epoch 1 prediction distribution: ['0.1046', '0.1464', '0.1650', '0.1078', '0.1835', '0.0636', '0.0853', '0.1438']
[2026-01-20 12:17:13] [INFO] [experiment] Updated prediction distributions to experiments/runs/sweep_1768904133/baseline/prediction_distributions.json
[2026-01-20 12:17:13] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-20 12:17:13] [INFO] [experiment] New best validation loss: 0.5257 (patience counter reset to 0)
[2026-01-20 12:17:48] [INFO] [experiment] Epoch 2/20 (35.35s): train_loss=0.6608, train_top1=0.1931, train_top3=0.8400, val_loss=0.5257 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-20 12:18:24] [INFO] [experiment] Epoch 3/20 (35.44s): train_loss=0.6055, train_top1=0.2706, train_top3=0.8921, val_loss=0.5257 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-20 12:18:57] [INFO] [experiment] Epoch 4/20 (32.90s): train_loss=0.5548, train_top1=0.2581, train_top3=0.9154, val_loss=0.5257 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
