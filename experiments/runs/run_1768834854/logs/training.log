[2026-01-19 17:00:54] [INFO] [experiment] Starting training
[2026-01-19 17:00:55] [INFO] [experiment] Using device: mps
[2026-01-19 17:00:55] [INFO] [experiment] Loading features from data/processed/features/compliant
[2026-01-19 17:00:55] [INFO] [src.training.dataset] Found 7 target_points.parquet files in data/processed/features/compliant
[2026-01-19 17:00:56] [INFO] [src.training.dataset] Combined 3636 total rows from 7 files, 7 unique neighborhoods
[2026-01-19 17:00:56] [INFO] [src.training.dataset] Created splits: Train=1844 rows (4 neighborhoods), Val=308 rows (1 neighborhoods), Test=1484 rows (2 neighborhoods)
[2026-01-19 17:00:56] [INFO] [experiment] Calculating class weights from training dataset...
[2026-01-19 17:00:56] [INFO] [experiment] Class counts: [487, 60, 478, 208, 27, 64, 479, 41]
[2026-01-19 17:00:56] [INFO] [experiment] Class weights (before damping): [3.786447525024414, 30.733333587646484, 3.857740640640259, 8.865385055541992, 68.29629516601562, 28.8125, 3.849686861038208, 44.975608825683594]
[2026-01-19 17:00:56] [INFO] [experiment] Class weights (after sqrt damping and capping at 3.0): [1.945879578590393, 3.0, 1.9641132354736328, 2.9774796962738037, 3.0, 3.0, 1.962061882019043, 3.0]
[2026-01-19 17:00:56] [INFO] [experiment] Data augmentation enabled: feature_noise (p=0.8, std=0.01), neighbor_subsampling (p=0.5, ratio=0.8), edge_noise (p=0.3, std=0.02)
[2026-01-19 17:00:56] [INFO] [experiment] Computing true class distribution from training dataset...
[2026-01-19 17:00:58] [INFO] [experiment] True distribution: ['0.1571', '0.0913', '0.1712', '0.1383', '0.0718', '0.0792', '0.1926', '0.0985']
[2026-01-19 17:00:58] [INFO] [experiment] Created datasets: Train=1844, Val=308, Test=1484
[2026-01-19 17:00:58] [INFO] [src.training.model] Created SpatialGraphTransformer: 47,752 parameters
[2026-01-19 17:00:58] [INFO] [experiment] Loss function: label_smoothing=0.0, class_weights capped at 3.0, entropy_weight=2.0, min_entropy=1.0
[2026-01-19 17:00:58] [INFO] [experiment] Initialized prediction distribution file: experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:00:58] [INFO] [experiment] Starting training loop
[2026-01-19 17:01:50] [INFO] [experiment] Epoch 1/100 (52.42s): train_loss=611.8436, train_top1=0.0130, train_top3=0.7462, val_loss=455.8808, val_kl=15.0647, val_top1=0.0260, val_top3=0.8994
[2026-01-19 17:02:16] [INFO] [experiment] Computing prediction distribution for epoch 1...
[2026-01-19 17:02:32] [INFO] [experiment] Epoch 1 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000', '0.0000', '0.0000']
[2026-01-19 17:02:32] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:02:32] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:02:32] [INFO] [experiment] New best validation loss: 455.8808
[2026-01-19 17:03:05] [INFO] [experiment] Epoch 2/100 (33.58s): train_loss=407.6570, train_top1=0.0846, train_top3=0.8368, val_loss=455.8808 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:03:38] [INFO] [experiment] Epoch 3/100 (32.33s): train_loss=292.9661, train_top1=0.1047, train_top3=0.8444, val_loss=455.8808 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:04:12] [INFO] [experiment] Epoch 4/100 (34.70s): train_loss=219.4074, train_top1=0.1090, train_top3=0.8471, val_loss=455.8808 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:05:00] [INFO] [experiment] Epoch 5/100 (47.81s): train_loss=159.5084, train_top1=0.1177, train_top3=0.7598, val_loss=666.8751, val_kl=15.0954, val_top1=0.0455, val_top3=0.8831
[2026-01-19 17:05:26] [INFO] [experiment] Computing prediction distribution for epoch 5...
[2026-01-19 17:05:41] [INFO] [experiment] Epoch 5 prediction distribution: ['1.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000']
[2026-01-19 17:05:41] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:06:17] [INFO] [experiment] Epoch 6/100 (35.59s): train_loss=120.0550, train_top1=0.1394, train_top3=0.8178, val_loss=666.8751 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:06:51] [INFO] [experiment] Epoch 7/100 (34.18s): train_loss=96.5101, train_top1=0.1486, train_top3=0.8113, val_loss=666.8751 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:07:26] [INFO] [experiment] Epoch 8/100 (35.15s): train_loss=75.5295, train_top1=0.1361, train_top3=0.7977, val_loss=666.8751 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:08:01] [INFO] [experiment] Epoch 9/100 (35.07s): train_loss=47.0086, train_top1=0.1415, train_top3=0.8091, val_loss=666.8751 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:08:49] [INFO] [experiment] Epoch 10/100 (47.66s): train_loss=32.6396, train_top1=0.1274, train_top3=0.8151, val_loss=523.6005, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:09:14] [INFO] [experiment] Computing prediction distribution for epoch 10...
[2026-01-19 17:09:29] [INFO] [experiment] Epoch 10 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:09:29] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:09:29] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_10.pt
[2026-01-19 17:10:02] [INFO] [experiment] Epoch 11/100 (32.58s): train_loss=18.1836, train_top1=0.1302, train_top3=0.8362, val_loss=523.6005 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:10:33] [INFO] [experiment] Epoch 12/100 (31.28s): train_loss=11.7512, train_top1=0.1535, train_top3=0.8444, val_loss=523.6005 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:11:03] [INFO] [experiment] Epoch 13/100 (29.70s): train_loss=12.2958, train_top1=0.1556, train_top3=0.8487, val_loss=523.6005 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:11:36] [INFO] [experiment] Epoch 14/100 (33.13s): train_loss=12.4222, train_top1=0.1562, train_top3=0.8563, val_loss=523.6005 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:12:29] [INFO] [experiment] Epoch 15/100 (52.76s): train_loss=10.7296, train_top1=0.1638, train_top3=0.8769, val_loss=484.8496, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:12:55] [INFO] [experiment] Computing prediction distribution for epoch 15...
[2026-01-19 17:13:11] [INFO] [experiment] Epoch 15 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:13:11] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:13:42] [INFO] [experiment] Epoch 16/100 (30.86s): train_loss=11.0305, train_top1=0.1600, train_top3=0.8888, val_loss=484.8496 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:14:13] [INFO] [experiment] Epoch 17/100 (31.25s): train_loss=9.9761, train_top1=0.1453, train_top3=0.8980, val_loss=484.8496 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:14:45] [INFO] [experiment] Epoch 18/100 (31.75s): train_loss=11.7359, train_top1=0.1578, train_top3=0.9018, val_loss=484.8496 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:15:15] [INFO] [experiment] Epoch 19/100 (29.97s): train_loss=10.4540, train_top1=0.1741, train_top3=0.9116, val_loss=484.8496 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:16:02] [INFO] [experiment] Epoch 20/100 (47.12s): train_loss=9.6928, train_top1=0.1708, train_top3=0.9132, val_loss=466.3010, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:16:26] [INFO] [experiment] Computing prediction distribution for epoch 20...
[2026-01-19 17:16:42] [INFO] [experiment] Epoch 20 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:16:42] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:16:42] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_20.pt
[2026-01-19 17:17:14] [INFO] [experiment] Epoch 21/100 (32.13s): train_loss=9.2623, train_top1=0.1931, train_top3=0.9300, val_loss=466.3010 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:17:45] [INFO] [experiment] Epoch 22/100 (31.07s): train_loss=10.3132, train_top1=0.1990, train_top3=0.9349, val_loss=466.3010 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:18:14] [INFO] [experiment] Epoch 23/100 (28.94s): train_loss=9.7531, train_top1=0.2137, train_top3=0.9485, val_loss=466.3010 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:18:47] [INFO] [experiment] Epoch 24/100 (32.95s): train_loss=10.2122, train_top1=0.2386, train_top3=0.9414, val_loss=466.3010 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:19:35] [INFO] [experiment] Epoch 25/100 (47.74s): train_loss=8.6445, train_top1=0.2283, train_top3=0.9507, val_loss=448.9412, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:20:00] [INFO] [experiment] Computing prediction distribution for epoch 25...
[2026-01-19 17:20:15] [INFO] [experiment] Epoch 25 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:20:15] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:20:15] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:20:15] [INFO] [experiment] New best validation loss: 448.9412
[2026-01-19 17:20:47] [INFO] [experiment] Epoch 26/100 (32.21s): train_loss=8.5170, train_top1=0.2142, train_top3=0.9507, val_loss=448.9412 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:21:17] [INFO] [experiment] Epoch 27/100 (30.04s): train_loss=9.0444, train_top1=0.2495, train_top3=0.9664, val_loss=448.9412 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:21:48] [INFO] [experiment] Epoch 28/100 (30.29s): train_loss=6.9177, train_top1=0.2495, train_top3=0.9631, val_loss=448.9412 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:22:18] [INFO] [experiment] Epoch 29/100 (30.44s): train_loss=8.9149, train_top1=0.2549, train_top3=0.9648, val_loss=448.9412 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:23:04] [INFO] [experiment] Epoch 30/100 (45.97s): train_loss=9.7785, train_top1=0.2375, train_top3=0.9664, val_loss=430.8588, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:23:28] [INFO] [experiment] Computing prediction distribution for epoch 30...
[2026-01-19 17:23:43] [INFO] [experiment] Epoch 30 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:23:43] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:23:43] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:23:43] [INFO] [experiment] New best validation loss: 430.8588
[2026-01-19 17:23:43] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_30.pt
[2026-01-19 17:24:15] [INFO] [experiment] Epoch 31/100 (32.30s): train_loss=9.6547, train_top1=0.2289, train_top3=0.9669, val_loss=430.8588 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:24:49] [INFO] [experiment] Epoch 32/100 (33.26s): train_loss=8.8054, train_top1=0.2326, train_top3=0.9685, val_loss=430.8588 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:25:27] [INFO] [experiment] Epoch 33/100 (38.72s): train_loss=7.3252, train_top1=0.2337, train_top3=0.9707, val_loss=430.8588 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:26:15] [INFO] [experiment] Epoch 34/100 (47.26s): train_loss=7.4840, train_top1=0.2424, train_top3=0.9631, val_loss=430.8588 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:27:06] [INFO] [experiment] Epoch 35/100 (50.88s): train_loss=7.4853, train_top1=0.2354, train_top3=0.9669, val_loss=411.2648, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:27:33] [INFO] [experiment] Computing prediction distribution for epoch 35...
[2026-01-19 17:27:49] [INFO] [experiment] Epoch 35 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:27:49] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:27:49] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:27:49] [INFO] [experiment] New best validation loss: 411.2648
[2026-01-19 17:28:25] [INFO] [experiment] Epoch 36/100 (36.20s): train_loss=8.3057, train_top1=0.2397, train_top3=0.9691, val_loss=411.2648 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:28:56] [INFO] [experiment] Epoch 37/100 (31.33s): train_loss=7.3603, train_top1=0.2381, train_top3=0.9626, val_loss=411.2648 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:29:27] [INFO] [experiment] Epoch 38/100 (30.46s): train_loss=6.9919, train_top1=0.2560, train_top3=0.9723, val_loss=411.2648 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:30:00] [INFO] [experiment] Epoch 39/100 (33.34s): train_loss=6.4026, train_top1=0.2495, train_top3=0.9713, val_loss=411.2648 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:30:47] [INFO] [experiment] Epoch 40/100 (46.87s): train_loss=7.1511, train_top1=0.2489, train_top3=0.9756, val_loss=392.9383, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:31:13] [INFO] [experiment] Computing prediction distribution for epoch 40...
[2026-01-19 17:31:29] [INFO] [experiment] Epoch 40 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:31:29] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:31:29] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:31:29] [INFO] [experiment] New best validation loss: 392.9383
[2026-01-19 17:31:29] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_40.pt
[2026-01-19 17:32:25] [INFO] [experiment] Epoch 41/100 (55.87s): train_loss=6.5906, train_top1=0.2402, train_top3=0.9756, val_loss=392.9383 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:33:15] [INFO] [experiment] Epoch 42/100 (49.90s): train_loss=5.7026, train_top1=0.2527, train_top3=0.9713, val_loss=392.9383 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:34:06] [INFO] [experiment] Epoch 43/100 (50.61s): train_loss=6.1225, train_top1=0.2332, train_top3=0.9810, val_loss=392.9383 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:35:07] [INFO] [experiment] Epoch 44/100 (61.09s): train_loss=6.2744, train_top1=0.2484, train_top3=0.9675, val_loss=392.9383 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:36:38] [INFO] [experiment] Epoch 45/100 (91.17s): train_loss=6.6396, train_top1=0.2652, train_top3=0.9729, val_loss=374.8110, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:37:09] [INFO] [experiment] Computing prediction distribution for epoch 45...
[2026-01-19 17:37:26] [INFO] [experiment] Epoch 45 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:37:26] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:37:26] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:37:26] [INFO] [experiment] New best validation loss: 374.8110
[2026-01-19 17:38:28] [INFO] [experiment] Epoch 46/100 (62.56s): train_loss=6.8781, train_top1=0.2462, train_top3=0.9761, val_loss=374.8110 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:39:16] [INFO] [experiment] Epoch 47/100 (47.60s): train_loss=4.6309, train_top1=0.2570, train_top3=0.9751, val_loss=374.8110 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:39:55] [INFO] [experiment] Epoch 48/100 (39.44s): train_loss=7.2806, train_top1=0.2527, train_top3=0.9685, val_loss=374.8110 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:40:48] [INFO] [experiment] Epoch 49/100 (52.91s): train_loss=7.0212, train_top1=0.2505, train_top3=0.9778, val_loss=374.8110 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:42:05] [INFO] [experiment] Epoch 50/100 (76.80s): train_loss=6.4592, train_top1=0.2348, train_top3=0.9740, val_loss=353.1515, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:42:34] [INFO] [experiment] Computing prediction distribution for epoch 50...
[2026-01-19 17:43:02] [INFO] [experiment] Epoch 50 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:43:02] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:43:02] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:43:02] [INFO] [experiment] New best validation loss: 353.1515
[2026-01-19 17:43:02] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_50.pt
[2026-01-19 17:44:05] [INFO] [experiment] Epoch 51/100 (62.90s): train_loss=6.8740, train_top1=0.2728, train_top3=0.9772, val_loss=353.1515 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:44:54] [INFO] [experiment] Epoch 52/100 (49.26s): train_loss=7.3908, train_top1=0.2831, train_top3=0.9729, val_loss=353.1515 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:45:45] [INFO] [experiment] Epoch 53/100 (50.56s): train_loss=5.5464, train_top1=0.2451, train_top3=0.9653, val_loss=353.1515 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:46:44] [INFO] [experiment] Epoch 54/100 (58.69s): train_loss=5.6645, train_top1=0.2413, train_top3=0.9778, val_loss=353.1515 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:48:06] [INFO] [experiment] Epoch 55/100 (82.20s): train_loss=6.4018, train_top1=0.2516, train_top3=0.9734, val_loss=329.7758, val_kl=12.4434, val_top1=0.4156, val_top3=0.9318
[2026-01-19 17:48:37] [INFO] [experiment] Computing prediction distribution for epoch 55...
[2026-01-19 17:48:59] [INFO] [experiment] Epoch 55 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:48:59] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:49:00] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:49:00] [INFO] [experiment] New best validation loss: 329.7758
[2026-01-19 17:50:07] [INFO] [experiment] Epoch 56/100 (67.84s): train_loss=6.2189, train_top1=0.2684, train_top3=0.9675, val_loss=329.7758 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:51:20] [INFO] [experiment] Epoch 57/100 (72.14s): train_loss=6.0358, train_top1=0.2495, train_top3=0.9761, val_loss=329.7758 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:51:55] [INFO] [experiment] Epoch 58/100 (35.73s): train_loss=6.2960, train_top1=0.2549, train_top3=0.9810, val_loss=329.7758 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:52:43] [INFO] [experiment] Epoch 59/100 (47.32s): train_loss=6.0310, train_top1=0.2674, train_top3=0.9718, val_loss=329.7758 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:54:00] [INFO] [experiment] Epoch 60/100 (77.58s): train_loss=5.4428, train_top1=0.2473, train_top3=0.9734, val_loss=306.1909, val_kl=12.4434, val_top1=0.4156, val_top3=0.9188
[2026-01-19 17:54:36] [INFO] [experiment] Computing prediction distribution for epoch 60...
[2026-01-19 17:54:58] [INFO] [experiment] Epoch 60 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 17:54:58] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 17:54:58] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 17:54:58] [INFO] [experiment] New best validation loss: 306.1909
[2026-01-19 17:54:58] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_60.pt
[2026-01-19 17:56:07] [INFO] [experiment] Epoch 61/100 (69.31s): train_loss=4.7248, train_top1=0.2516, train_top3=0.9778, val_loss=306.1909 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:56:58] [INFO] [experiment] Epoch 62/100 (50.42s): train_loss=5.2387, train_top1=0.2435, train_top3=0.9751, val_loss=306.1909 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:57:33] [INFO] [experiment] Epoch 63/100 (35.45s): train_loss=4.5673, train_top1=0.2652, train_top3=0.9794, val_loss=306.1909 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:58:22] [INFO] [experiment] Epoch 64/100 (48.75s): train_loss=6.3073, train_top1=0.2603, train_top3=0.9696, val_loss=306.1909 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 17:59:32] [INFO] [experiment] Epoch 65/100 (69.74s): train_loss=4.3080, train_top1=0.2587, train_top3=0.9729, val_loss=277.2813, val_kl=12.4364, val_top1=0.4156, val_top3=0.9188
[2026-01-19 18:00:00] [INFO] [experiment] Computing prediction distribution for epoch 65...
[2026-01-19 18:00:21] [INFO] [experiment] Epoch 65 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 18:00:21] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 18:00:21] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 18:00:21] [INFO] [experiment] New best validation loss: 277.2813
[2026-01-19 18:01:24] [INFO] [experiment] Epoch 66/100 (62.96s): train_loss=3.6208, train_top1=0.2695, train_top3=0.9745, val_loss=277.2813 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 18:02:15] [INFO] [experiment] Epoch 67/100 (51.03s): train_loss=4.5206, train_top1=0.2652, train_top3=0.9702, val_loss=277.2813 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 18:03:05] [INFO] [experiment] Epoch 68/100 (50.32s): train_loss=4.3856, train_top1=0.2500, train_top3=0.9680, val_loss=277.2813 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 18:04:20] [INFO] [experiment] Epoch 69/100 (74.16s): train_loss=3.7022, train_top1=0.2462, train_top3=0.9778, val_loss=277.2813 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 18:05:47] [INFO] [experiment] Epoch 70/100 (87.29s): train_loss=3.7629, train_top1=0.2424, train_top3=0.9718, val_loss=254.2163, val_kl=12.0706, val_top1=0.4156, val_top3=0.9188
[2026-01-19 18:06:29] [INFO] [experiment] Computing prediction distribution for epoch 70...
[2026-01-19 18:06:51] [INFO] [experiment] Epoch 70 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 18:06:51] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 18:06:51] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 18:06:51] [INFO] [experiment] New best validation loss: 254.2163
[2026-01-19 18:06:51] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_70.pt
[2026-01-19 20:06:07] [INFO] [experiment] Epoch 71/100 (7156.48s): train_loss=3.7573, train_top1=0.2706, train_top3=0.9745, val_loss=254.2163 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:06:41] [INFO] [experiment] Epoch 72/100 (33.84s): train_loss=4.6342, train_top1=0.2549, train_top3=0.9713, val_loss=254.2163 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:07:15] [INFO] [experiment] Epoch 73/100 (33.55s): train_loss=3.6830, train_top1=0.2419, train_top3=0.9745, val_loss=254.2163 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:07:50] [INFO] [experiment] Epoch 74/100 (35.08s): train_loss=4.2492, train_top1=0.2608, train_top3=0.9789, val_loss=254.2163 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:08:43] [INFO] [experiment] Epoch 75/100 (53.44s): train_loss=3.8729, train_top1=0.2495, train_top3=0.9707, val_loss=233.1434, val_kl=11.8459, val_top1=0.4156, val_top3=0.9188
[2026-01-19 20:09:09] [INFO] [experiment] Computing prediction distribution for epoch 75...
[2026-01-19 20:09:24] [INFO] [experiment] Epoch 75 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000']
[2026-01-19 20:09:24] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 20:09:24] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 20:09:24] [INFO] [experiment] New best validation loss: 233.1434
[2026-01-19 20:09:58] [INFO] [experiment] Epoch 76/100 (34.03s): train_loss=4.2645, train_top1=0.2430, train_top3=0.9745, val_loss=233.1434 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:10:30] [INFO] [experiment] Epoch 77/100 (31.50s): train_loss=3.1196, train_top1=0.2402, train_top3=0.9707, val_loss=233.1434 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:10:58] [INFO] [experiment] Epoch 78/100 (28.01s): train_loss=3.5539, train_top1=0.2467, train_top3=0.9816, val_loss=233.1434 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:11:33] [INFO] [experiment] Epoch 79/100 (35.57s): train_loss=3.6606, train_top1=0.2543, train_top3=0.9745, val_loss=233.1434 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:12:24] [INFO] [experiment] Epoch 80/100 (50.65s): train_loss=4.1663, train_top1=0.2570, train_top3=0.9767, val_loss=208.8697, val_kl=11.4200, val_top1=0.4156, val_top3=0.9188
[2026-01-19 20:12:48] [INFO] [experiment] Computing prediction distribution for epoch 80...
[2026-01-19 20:13:04] [INFO] [experiment] Epoch 80 prediction distribution: ['0.0055', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.9945', '0.0000']
[2026-01-19 20:13:04] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 20:13:04] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 20:13:04] [INFO] [experiment] New best validation loss: 208.8697
[2026-01-19 20:13:04] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_80.pt
[2026-01-19 20:13:38] [INFO] [experiment] Epoch 81/100 (34.46s): train_loss=3.5217, train_top1=0.2408, train_top3=0.9772, val_loss=208.8697 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:14:08] [INFO] [experiment] Epoch 82/100 (29.76s): train_loss=3.5871, train_top1=0.2668, train_top3=0.9783, val_loss=208.8697 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:14:36] [INFO] [experiment] Epoch 83/100 (28.29s): train_loss=3.0567, train_top1=0.2430, train_top3=0.9767, val_loss=208.8697 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:15:08] [INFO] [experiment] Epoch 84/100 (31.46s): train_loss=2.6716, train_top1=0.2565, train_top3=0.9805, val_loss=208.8697 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:15:57] [INFO] [experiment] Epoch 85/100 (49.58s): train_loss=2.4666, train_top1=0.2641, train_top3=0.9821, val_loss=190.0614, val_kl=11.2955, val_top1=0.0455, val_top3=0.9188
[2026-01-19 20:16:22] [INFO] [experiment] Computing prediction distribution for epoch 85...
[2026-01-19 20:16:38] [INFO] [experiment] Epoch 85 prediction distribution: ['0.6798', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.3202', '0.0000']
[2026-01-19 20:16:38] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 20:16:38] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 20:16:38] [INFO] [experiment] New best validation loss: 190.0614
[2026-01-19 20:17:12] [INFO] [experiment] Epoch 86/100 (34.27s): train_loss=3.6772, train_top1=0.2538, train_top3=0.9751, val_loss=190.0614 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:17:40] [INFO] [experiment] Epoch 87/100 (28.29s): train_loss=3.2327, train_top1=0.2522, train_top3=0.9761, val_loss=190.0614 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:18:08] [INFO] [experiment] Epoch 88/100 (28.10s): train_loss=3.2944, train_top1=0.2408, train_top3=0.9740, val_loss=190.0614 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:18:43] [INFO] [experiment] Epoch 89/100 (34.73s): train_loss=3.1943, train_top1=0.2278, train_top3=0.9723, val_loss=190.0614 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:19:34] [INFO] [experiment] Epoch 90/100 (51.23s): train_loss=2.9844, train_top1=0.2587, train_top3=0.9794, val_loss=179.9777, val_kl=12.8764, val_top1=0.0455, val_top3=0.8669
[2026-01-19 20:19:59] [INFO] [experiment] Computing prediction distribution for epoch 90...
[2026-01-19 20:20:14] [INFO] [experiment] Epoch 90 prediction distribution: ['0.9998', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0002', '0.0000']
[2026-01-19 20:20:14] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 20:20:14] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 20:20:14] [INFO] [experiment] New best validation loss: 179.9777
[2026-01-19 20:20:14] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_epoch_90.pt
[2026-01-19 20:20:50] [INFO] [experiment] Epoch 91/100 (36.30s): train_loss=3.4467, train_top1=0.2560, train_top3=0.9756, val_loss=179.9777 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:21:22] [INFO] [experiment] Epoch 92/100 (31.76s): train_loss=2.6987, train_top1=0.2419, train_top3=0.9734, val_loss=179.9777 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:21:50] [INFO] [experiment] Epoch 93/100 (27.52s): train_loss=3.1695, train_top1=0.2641, train_top3=0.9767, val_loss=179.9777 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:22:25] [INFO] [experiment] Epoch 94/100 (34.96s): train_loss=3.5810, train_top1=0.2641, train_top3=0.9772, val_loss=179.9777 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 20:23:15] [INFO] [experiment] Epoch 95/100 (50.18s): train_loss=2.9056, train_top1=0.2440, train_top3=0.9783, val_loss=159.7633, val_kl=12.7478, val_top1=0.0455, val_top3=0.8669
[2026-01-19 20:23:40] [INFO] [experiment] Computing prediction distribution for epoch 95...
[2026-01-19 20:23:55] [INFO] [experiment] Epoch 95 prediction distribution: ['0.9996', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0004', '0.0000']
[2026-01-19 20:23:55] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768834854/prediction_distributions.json
[2026-01-19 20:23:55] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 20:23:55] [INFO] [experiment] New best validation loss: 159.7633
