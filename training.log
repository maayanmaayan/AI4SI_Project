[2026-01-19 16:04:02] [INFO] [experiment] Starting training
[2026-01-19 16:04:02] [INFO] [experiment] Using device: mps
[2026-01-19 16:04:02] [INFO] [experiment] Loading features from data/processed/features/compliant
[2026-01-19 16:04:02] [INFO] [src.training.dataset] Found 7 target_points.parquet files in data/processed/features/compliant
[2026-01-19 16:04:06] [INFO] [src.training.dataset] Combined 3636 total rows from 7 files, 7 unique neighborhoods
[2026-01-19 16:04:06] [INFO] [src.training.dataset] Created splits: Train=1844 rows (4 neighborhoods), Val=308 rows (1 neighborhoods), Test=1484 rows (2 neighborhoods)
[2026-01-19 16:04:06] [INFO] [experiment] Calculating class weights from training dataset...
[2026-01-19 16:04:06] [INFO] [experiment] Class counts: [487, 60, 478, 208, 27, 64, 479, 41]
[2026-01-19 16:04:06] [INFO] [experiment] Class weights (before damping): [3.786447525024414, 30.733333587646484, 3.857740640640259, 8.865385055541992, 68.29629516601562, 28.8125, 3.849686861038208, 44.975608825683594]
[2026-01-19 16:04:06] [INFO] [experiment] Class weights (after sqrt damping and capping at 3.0): [1.945879578590393, 3.0, 1.9641132354736328, 2.9774796962738037, 3.0, 3.0, 1.962061882019043, 3.0]
[2026-01-19 16:04:06] [INFO] [experiment] Computing true class distribution from training dataset...
[2026-01-19 16:04:08] [INFO] [experiment] True distribution: ['0.1571', '0.0913', '0.1712', '0.1383', '0.0718', '0.0792', '0.1926', '0.0985']
[2026-01-19 16:04:08] [INFO] [experiment] Created datasets: Train=1844, Val=308, Test=1484
[2026-01-19 16:04:08] [INFO] [src.training.model] Created SpatialGraphTransformer: 47,752 parameters
[2026-01-19 16:04:08] [INFO] [experiment] Loss function: label_smoothing=0.0, class_weights capped at 3.0
[2026-01-19 16:04:08] [INFO] [experiment] Initialized prediction distribution file: experiments/runs/run_1768831442/prediction_distributions.json
[2026-01-19 16:04:08] [INFO] [experiment] Starting training loop
[2026-01-19 16:05:09] [INFO] [experiment] Epoch 1/100 (60.80s): train_loss=1223.6646, train_top1=0.0136, train_top3=0.6795, val_loss=909.6201, val_kl=15.0647, val_top1=0.0260, val_top3=0.8994
[2026-01-19 16:05:45] [INFO] [experiment] Computing prediction distribution for epoch 1...
[2026-01-19 16:06:01] [INFO] [experiment] Epoch 1 prediction distribution: ['0.0000', '0.0000', '0.0000', '0.0000', '1.0000', '0.0000', '0.0000', '0.0000']
[2026-01-19 16:06:01] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768831442/prediction_distributions.json
[2026-01-19 16:06:01] [INFO] [src.training.train] Saved checkpoint to models/checkpoints/graph_transformer_best.pt
[2026-01-19 16:06:01] [INFO] [experiment] New best validation loss: 909.6201
[2026-01-19 16:06:38] [INFO] [experiment] Epoch 2/100 (37.71s): train_loss=815.2851, train_top1=0.0857, train_top3=0.8384, val_loss=909.6201 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 16:07:15] [INFO] [experiment] Epoch 3/100 (36.37s): train_loss=585.4247, train_top1=0.0982, train_top3=0.8438, val_loss=909.6201 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 16:08:02] [INFO] [experiment] Epoch 4/100 (47.16s): train_loss=437.7642, train_top1=0.0992, train_top3=0.8492, val_loss=909.6201 (last), val_kl=N/A, val_top1=N/A, val_top3=N/A
[2026-01-19 16:09:13] [INFO] [experiment] Epoch 5/100 (71.34s): train_loss=317.9292, train_top1=0.1014, train_top3=0.7440, val_loss=1348.4507, val_kl=15.0954, val_top1=0.0455, val_top3=0.8831
[2026-01-19 16:09:39] [INFO] [experiment] Computing prediction distribution for epoch 5...
[2026-01-19 16:09:55] [INFO] [experiment] Epoch 5 prediction distribution: ['1.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000', '0.0000']
[2026-01-19 16:09:55] [INFO] [experiment] Updated prediction distributions to experiments/runs/run_1768831442/prediction_distributions.json
/opt/homebrew/Cellar/python@3.14/3.14.0_1/Frameworks/Python.framework/Versions/3.14/lib/python3.14/multiprocessing/resource_tracker.py:297: UserWarning: resource_tracker: There appear to be 14 leaked semaphore objects to clean up at shutdown: {'/mp-f758cedl', '/mp-ol5yacjx', '/mp-i22bsnny', '/mp-uwt84cem', '/mp-kpotxodr', '/mp-72kzfe_7', '/mp-2axkj86b', '/mp-96pbah61', '/mp-d4mukulf', '/mp-6gcoer55', '/mp-7wxenw46', '/mp-pqr_1esx', '/mp-_zgp4obv', '/mp-sa7yrmm2'}
  warnings.warn(
-yv165ias', '/mp-ej4qciu7', '/mp-50o9in98', '/mp-lyhwimnp', '/mp-fbmcqwf1', '/mp-rc1z3twm', '/mp-8zzup98l', '/mp-y8_musjw', '/mp-jw1f4dye', '/mp-gpd16bzl', '/mp-qdmlinrp'}
  warnings.warn(
